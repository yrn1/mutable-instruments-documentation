![](images/front_small.jpg)

## Key data

*Segment generator*

Parameter    | Value
-------------|------
Width        | 14HP
Depth        | 25mm
+12V current | 80mA
-12V current | 20mA
Lifetime     | 03/18 to 07/22
Modulargrid  | [Link](https://www.modulargrid.net/e/mutable-instruments-stages)
Processor    | STM32F373RBT6 @ 72 MHz
DAC          | DAC8168

## Features

### Flexible input/output layout

The module detects the presence of jacks on its gate inputs to group its segments: whether it is configured as a complex 6-stage envelope, or 6 individual envelopes, or 3+3, 2+4... depends simply on how you patch it. Dummy patch cables might come handy!

When used as a multi-segment envelope, a segment activation signal is produced on all secondary outputs - for example to trigger an external event when an ADSR envelope enters its decay, sustain or release stages.

In case more than 6 segments are required, up to six modules can be chained together thanks to a connector at the back of the module.

### Three segment types

* **Ramp** segments go from one voltage to another, in a CV-controlled amount of time, with an adjustable curve (accelerating, uniform, decelerating). They are the building block used for the attack, decay or release segments in envelopes... or for LFOs.
* **Hold** segments stay at a constant (but CV-controllable) voltage for a programmable amount of time. They serve as the sustain or hold segments in envelopes.
* **Step** segments glide to a target (CV-controllable) voltage, then stay at this voltage for a certain amount of time until a trigger is received. They are the main ingredient for step sequences, but also for building sequential switches or a sample-and-hold.

### Looping

A segment, or a group of segments, can loop on itself: if the last segment of the envelope is included in the loop, the loop lasts forever. Otherwise, the loop remains active while the gate is high, then continues past the last segment of the loop. These two behaviors allow the creation of self-looping envelopes (LFOs), or the sustain stage of a good old ADSR envelope!

### Single segment processing

Even when they aren't part of any group and don't receive any gate or trigger signals, individual segments can perform interesting functions: **Ramp** can loop on itself and turn into an LFO, **Hold** can delay a CV and **Step** can slew it.

Now patch a trigger signal: the self-looping **Ramp** turns into a tempo-synced LFO, the **Hold** segment becomes a pulse generator, the **Step** segment a sample-and-hold.

### Specifications

* CV output: from 0V to +8V. A negative CV down to -8V can be generated by a **Hold** or **Step** segment if this segment is CV modulated.
* Segment duration from 1ms to 16s.
* All inputs: 100k impedance, DC to 2kHz.
* 31.25kHz refresh rate.
* 16-bit CV capture, 14-bit CV generation with accurate software calibration. Error below 2mV.

## Installation

Stages requires a **-12V/+12V** power supply (2x5 pin connector). The red stripe of the ribbon cable (-12V side) must be oriented on the same side as the ‚ÄúRed stripe‚Äù marking on the module and on your power distribution board.
The module draws **80mA** from the +12V rail, and **20mA** from the -12V rail.

## Chaining modules

Use the 3-pin cables provided with the modules to daisy-chain up to six modules together. Make sure your Eurorack system is powered off whenever you connect or disconnect units from the chain. Once several adjacent modules are linked, they behave collectively like a single **Stages** module which would have a larger number of segments.

![](images/daisychain.jpg)

## Grouping segments

Whether **Stages** behaves like six independent decay envelopes, or a single 6-segment envelope generator, or something in-between, depends on which of its **GATE** inputs are patched.

Inserting a jack in a **GATE** input marks the beginning of a group of segments. All unpatched segments at its right become part of this group. The first output of a group generates the envelope signal itself. The following outputs generate segment activity signals ‚Äì ramps going from 8V to 0V whenever the corresponding segment is active.

In the illustration below, **GATE inputs 1 and 5 are patched**. The module behaves as:

* **A 4-segment envelope generator**, configured by segments 1 to 4, generating its envelope signal on output 1, and segment activity signals on outputs 2, 3, and 4.
* **An independent 2-segment envelope generator**, configured by segments 5 and 6, generating the envelope signal on output 5, and an end-of-attack signal on output 6.

![](images/groups.png)

What happens if only **GATE** input 5 is patched? Segments 5 and 6 act as a 2-segment envelope generator; and segments 1, 2, 3 and 4 are four independent free-running generators. Even if these four independent generators do not receive gates or triggers, looping can be enabled for them, turning them, for example, into four LFOs.

A few more examples:

* **No GATE input is patched**: Segments 1 to 6 are all independent, free running segments.
* **GATE inputs 1, 3 and 5 are patched**: Three independent 2-segment envelopes.
* **GATE inputs 1, 5 and 6 are patched**: One 4-segment envelope and two single-segment envelopes.
* **All GATE inputs are patched**: Six independent single-segment envelopes.

#### Tips

When building a patch, patch from right to left. For example, starting from a blank page, if you need an AD envelope, patch your gate signal into the **GATE** input of segment 5 ‚Äì leaving you segments 1 to 4 for LFOs, utility functions... or other envelopes.

Self-patching is rewarding with **Stages**! For example, configure segment 1 as an independent, free running LFO to modulate other segments.

It is sometimes handy to use "dummy" patch cables (or just a jack with no cable attached to it). For example, if you have created a 6-segment envelope spanning segments 1 to 6, and if you want to change its shape to a classic 4-segment ADSR, patch a dummy cable into input 5 to "detach" segments 5 and 6 from the chain starting at segment 1.

#### Segment activity signals

The illustration below shows the signals produced on outputs 1 to 4, assuming the module is used as a 4-segment ADSR (segments 5 and 6 are used for other duties).

![](images/segment_activity.jpg)

## Configuring segments

![](images/manual.png)

Press the button **[B]** to modify the action performed by a segment.

![](images/segment_ramp.png)

The output **smoothly ramps from one voltage to another**, then the next segment is activated. The ramping time is controlled by the slider **[C]** and the CV input **[1]**. The shape of the curve is controlled by the potentiometer **[A]**, from accelerating, through uniform, to decelerating.

![](images/ramp_shapes.jpg)

The following illustration shows how these shapes can be combined for an AD envelope:

![](images/ad_shapes.jpg)

![](images/segment_step.png)

The output **glides to the target voltage**, stays at this voltage until a trigger is received, and then the next segment is activated. Just like a step in a sequence! The voltage (from 0V to 8V) is controlled by the slider **[C]** and the CV input **[1]**. The glide amount is set by the potentiometer **[A]**.

![](images/segment_hold.png)

The output **stays at the same voltage for an adjustable duration**, then the next segment is activated. The voltage (from 0V to 8V) is controlled by the slider **[C]** and the CV input **[1]**. The duration of the segment is set by the potentiometer **[A]**.

![](images/loop_icon.png)

To make a segment loop on itself, hold the button **[B]** for one second. The LED now blinks to indicate the loop.

To create a loop spanning several segments within the same group, simultaneously press the button **[B]** of the first and last segments in the loop. The corresponding LEDs will blink with a ‚Äúping pong‚Äù pattern.

To disable a loop, hold the button **[B]** of either the start or end segment of the loop.

**Important:** a loop can only span segments belonging to the same group. And what defines groups? The presence of jacks in the **GATE** input! For example, if you want to use **Stages** as 3 self-looping AD envelopes, you'll need to insert "dummy" patch cables into the inputs #1, #3, #5 to explicitly tell the module that segments 1 and 2, 3 and 4, 5 and 6 are grouped together.

## Segment rules

![](images/segment_rules.png)

1. The first **RAMP** segment ramps up to 8V, starting from whatever level the output currently stays at.
2. The last **RAMP** segment ramps down to 0V.
3. The level of a **HOLD** or **STEP** segment defines the start (end) level of the RAMP segment that follows (precedes) it. For example, in the preceding illustration, the end level of segment 3, and the start level of segment 5 are both set by the level of the **HOLD** segment 4.
4. If the end level of a **RAMP** segment cannot be determined by rules 1, 2 or 3, this level is explicitly set by the potentiometer **[A]**. For example, in the preceding illustration, the end level of segments 2 and 5 are set by their potentiometer.
5. If a **LOOP** is defined, the loop is played while the **GATE** signal is high. Once the **GATE** goes low, the envelope proceeds with the segment(s) that follow the loop end point. If the loop end is the last segment, there‚Äôs no escape from the loop, and the loop keeps going on forever.
6. If the envelope contains a **STEP** segment, it follows its course normally until it gets trapped at the first **STEP** segment. It will stay at this segment until the next trigger is received. When this trigger is received, it will then proceed to the next segment... until the last segment or another **STEP** segment is reached. If an envelope contains a **STEP** segment inside a loop, there is no way of escaping this loop!

## Single segment processing

As a direct consequence of the segment rules (with a few tweaks!), an independent, isolated segment can perform a variety of interesting functions.

![](images/segment_ramp.png)

A non-looping single **RAMP** segment is a Decay envelope generator, with its decay time adjusted by the slider **[C]** and CV input **[1]**, and its curve adjusted by the potentiometer **[A]**.

A looping single **RAMP** segment behaves like an LFO, the waveform of which is controlled by the potentiometer **[A]**. Instead of the simple logarithmic/linear/exponential curves, a more sensible selection of waveforms is provided: variable slope saw/triangle, sine, variable slope trapezoid. If the **GATE** input is not patched, the LFO frequency is set by the slider **[C]** and CV input **[1]**. If the **GATE** input is patched, the LFO follows the tempo set by the **GATE** signal, with a clock division/multiplication factor from 1/4 to 4 set by the slider.

![](images/lfo_shapes.jpg)

![](images/segment_step.png)

A single **STEP** segment works as a sample and hold: at every rising edge of the **GATE**, it records and holds the voltage set by the slider **[C]** and CV input **[1]**. Use the potentiometer **[A]** to change the glide rate.

If nothing is patched in the **GATE** input, the slider and CV input will be continuously tracked, but will still be subject to the glide effect.

![](images/segment_hold.png)

If the **GATE** input is patched, an independent **HOLD** segment behaves as a pulse generator. The slider **[C]** and CV input **[1]** set the pulse voltage, while the potentiometer **[A]** controls the pulse duration. If looping is enabled, the pulse lasts for as long as the gate signal is high.

If the **GATE** input is not patched, the segment behaves as a CV delay. The voltage set by the slider **[C]** and CV input **[1]** is sent to the output with a delay set by the potentiometer **[A]**.  Even without an external CV patched into the input, you can use this as a slider-controlled CV source with delayed action.

## Examples

Many envelope shapes can be programmed with Stages. The arrows denote the loop region.

![](images/example_1.png)

Classic ADSR envelope.

![](images/example_2.png)

Classic ADSR envelope with an adjustable pre-delay and initial level.

![](images/example_3.png)

ADSR envelope with a non-zero rest level, adjusted by the last **HOLD** segment. The CV output for the last segment can be used as an end-of-release trigger.

![](images/example_4.png)

AHDSR envelope ‚Äì the hold level and time are controlled by the second segment.

![](images/example_5.png)

AD1D2SR envelope with a break point between the apex and sustain. The potentiometer **[A]** of the second segment controls the voltage at this break point.

![](images/example_6.png)

An even more complex AD1D2SR1R2 envelope, with break points at both the decay and the release stages.

![](images/example_7.png)

AD envelope.

![](images/example_8.png)

AR envelope. The sustain level is set by the HOLD segment.

![](images/example_9.png)

A trapezoid LFO, with the minimum and maximum level and plateau durations set by the segment 2 and 4; and the time and curve of the ramp set by the segment 1 and 3.

![](images/example_10.png)

A 5-note sequence. Modify the loop points to loop on a subset of this sequence. Patch external voltages into the CV inputs of each stage, to turn this into a 5-stage sequential switch.

![](images/example_11.png)

A 3-note sequence, with adjustable linear glide between each step.

## Advanced topics

### <a name="firmware"></a> Firmware update procedure

Unplug all CV inputs/outputs from the module. Connect the output of your audio interface/sound card to the **TIME/LEVEL** CV input **(1)** of the **last segment**. Set the **TIME/LEVEL** slider **[C]** of the last segment to an intermediate position. Power on your modular system with the last segment action selection button **(B)** pressed.

Make sure that no additional sound (such as email notification sounds, background music etc.) from your computer will be played during the procedure. Make sure that your speakers/monitors are not connected to your audio interface - the noises emitted during the procedure are aggressive and can harm your hearing. On non-studio audio equipment (for example the line output from a desktop computer), you might have to turn up the gain to the maximum.

When you are all set, play the firmware update file into the module. While the module receives data, the six LEDs will act as vu-meter (3 or 4 LEDs are lit when the signal level is optimal). Try moving the **TIME/LEVEL** slider to adjust gain. When the end of the audio file is reached, the module automatically restarts - if it is not the case, please retry the procedure from the beginning.

In case the signal level is inadequate, all LEDs will blink in red. Press the button **(B)** and retry with a higher gain. If this does not help, please retry the procedure from another computer/audio interface, and make sure that no piece of equipment or software effect (equalizer, automatic gain control, FX processor) is inserted in the signal chain.

## Easter egg

**Ouroboros**, an additive synthesis oscillator with 6 partials.

Use the chaining cable to link the module to itself.

The first channel sets the fundamental frequency: slider for coarse tuning, pot for fine-tuning. The **CV** input will track **V/O**.

For the remaining channels, the slider and **CV** input set the amplitude of the harmonic, and the pot adjusts its frequency ratio.

Output 1 contains all harmonics mixed and enveloped, outputs 2-6 contain each individual harmonics.

The **GATE** inputs can be used to "ping" an individual harmonic.

Finally, the segment type buttons cycle through different waveforms:

* **Green**: sine
* **Orange**: triangle
* **Red**: square
* **Green** blinking: saw
* **Orange** blinking: 25% pulse
* **Red** blinking: 10% pulse

## Revisions

### v1.2 (final)

#### Fixes and minor improvements

* The S&H applies a 2ms delay before sampling the CV, to play well with CV/Gate sources with a slewed or delayed CV signal.
* When using a clocked LFO segment, the edges of the LFO waveforms are aligned with the rising edge of the clock.
* The amount of hysteresis in the quantizer responsible for converting a voltage or slider position into discrete settings (eg: an LFO divider ratio, or a sequencer step address) has been lowered. This makes the relationship between a voltage (or position) and a specific setting more consistent when controlled by a sequencer.
* Taking inspiration from [qiemem's alternative firmware](https://github.com/qiemem/eurorack/tree/bipolar/stages), the **SHAPE/TIME** knob for a solo looping red segment controls the probability of accepting the gate gate.
* Taking inspiration from [qiemem's alternative firmware](https://github.com/qiemem/eurorack/tree/bipolar/stages), the module tracks any adjustment made to the level of the previous segment, instead of sampling it. This allows crossfading or pseudo-VCA applications.
* The clock tracking algorithm (for a solo looping green segment) reuses code from Tides 2018, and benefits from a few improvements, for instance no spurious reset when tracking very slow clocks.
* When the module operates as a harmonic oscillator, a mild low-pass filter is applied on the amplitude slider to reduce noise.
* The memory footprint has been kept under 24kb to prevent rare bugs occurring with modules built with the STM32F373RBT6 MCU, which has been used occasionally to finish produ. As a result, a slightly smaller buffer is used for the CV delay feature.

#### Extended sequencer mode

In order to access this extended sequencer, simply put a **HOLD** or **RAMP** segment at the beginning of your step sequence. For example, to create a 4-step sequence with extended control, create a **RAMP** **STEP** **STEP** **STEP** **STEP** group.

The first segment will not be part of your sequence, but will control the playback and the quantization:

The **SHAPE/TIME** pot of the first segment controls the playback mode:

* Up
* Down
* Pendulum
* Alternating (plays steps 1, 2, 1, 3, 1, 4, 1, 3, 1, 2‚Ä¶)
* Random
* Pseudo-random (without repeats)
* Addressable

The **GATE** input of this first segment continues working as a clock, and the sequence CV is also being output by the first segment. When using the addressable playback mode, the clock signal is ignored.

The **TIME/LEVEL** CV input (and its slider) either serves as an address CV control when using the addressable playback mode, or as a reset input, when using one of the other playback modes.

If the first segment is a **HOLD** segment, no quantization is applied and the output range is full (a range of 0 to 8V is selected by the slider). If the first segment is a **RAMP** segment, the output range is limited to 0-1V, and the steps are quantized to semitones (ie, increments of 1/12V).

If your segments contain a loop, playback and addressing will be restricted to the looped portion.

The reset input works as follows. A rising edge on this input resets the sequencer to the first step, and inhibit the next clock pulse if it comes within the next 5ms. The clock is also inhibited while the reset input is held high.

The active step is continuously sampled, allowing the module to be used as a sequential or CV-addressable ‚Äúswitch‚Äù.

#### Audio oscillator

Hold for more than 3s the segment type selection button of a solo segment (clocked or not) to turn this segment into an audio oscillator. The LED goes through a complex blinking pattern to indicate that this function is active. This is indeed a variant of the LFO with the following differences:

* The output is bipolar (+/- 5V).
* A different selection of waveforms is accessible with the **SHAPE/TIME** potentiometer: triangle with variable slope -> sawtooth -> sawtooth and square blend -> square with variable pulse width.
* Band-limited synthesis.
* The frequency tracking algorithm used to track the signal on the **GATE** input, adapted from Tides 2018, is optimized for locking onto audio-rate signals.
* A root note of C4 is played with the slider mid-way.
* The blinking rate of the slider's LED provides assistance with tuning: its rate slows down as the note gets closer to a C. This can also be used to help tuning an external oscillator connected to the **GATE** input.

### v1.1

* Powering the module on while pressing the **left** button enables (or disables) the color-blind mode. The LED brightness and blinking patterns are more contrasted:

	* **RAMP**: moderate brightness, with a faint brightness modulation. Smooth blinking pattern when the loop is enabled.
	
	* **STEP**: high brightness. Sharp blinking pattern when the loop is enabled.

	* **HOLD**: low brightness. Sharp blinking pattern when the loop is enabled.

### v1.0

Initial release.

# Qiemem

## Reference tables

- Button + slider: Hold button and move slider to top, middle, or bottom to change value
- Button + pot: Hold button and wiggle pot to toggle

Control overview (modes in order of corresponding button; hold button for 5 seconds to switch):
| Mode             | Button   | Hold button 1s | Slider + CV                                                    | Pot                                                                       | Button + slider                                                  | Button + pot                                            |
| ---------------- | -------- | -------------- | -------------------------------------------------------------- | ------------------------------------------------------------------------- | ---------------------------------------------------------------- | ------------------------------------------------------- |
| Segment gen      | Seg type | Toggle ‚û∞     | <pre>Time:  üü¢<br>Level: üü°üî¥</pre>                         | <pre>Shape: üü¢üü°<br>Time:  üî¥                                          | <pre>Time range:  üü¢<br>Quant scale: üü°üî¥</pre>               | <pre>Polarity: ‚û∞üü¢,üü°üî¥<br>Re-trig:  üü¢</pre>     |
| Adv segment gen  | Seg type | Toggle ‚û∞     | <pre>Time:  üü¢‚ò¢Ô∏èÔ∏è<br>Level: üü°üî¥<br>Prob:  üïü‚ò¢Ô∏è</pre> | <pre>Shape: üü¢üü°‚ò¢Ô∏èÔ∏è<br>Atten: ‚û∞üü°<br>Time:  üî¥<br>Steps: üïü‚ò¢Ô∏è | <pre>Time range:  üü¢‚ò¢Ô∏èÔ∏è<br>Quant scale: üü°üî¥,üïü‚ò¢Ô∏è</pre> | <pre>Polarity: ‚û∞üü¢,üü°üî¥‚ò¢Ô∏è<br>Re-trig:  üü¢</pre> |
| Slow LFO         | Seg type | Toggle ‚û∞     | <pre>Time:  üü¢<br>Level: üü°üî¥</pre>                         | <pre>Shape: üü¢üü°<br>Time:  üî¥                                          | <pre>Time range:  üü¢<br>Quant scale: üü°üî¥</pre>               | <pre>Polarity: ‚û∞üü¢,üü°üî¥<br>Re-trig:  üü¢</pre>     |
| DAHDSR           | Gate     | -              | Time / level (5)                                               | Shape (246)                                                               | -                                                                | -                                                       |
| Harmonic osc     | Shape    | Toggle shapes  | Freq (1) / amp                                                 | Tune (1) / harmony                                                        | Freq range (1)                                                   | -                                                       |
| Alt harmonic osc | Shape    | Toggle shapes  | Freq (1) / harmony                                             | Tune (1) / amp                                                            | Freq range (1)                                                   | -                                                       |

- üü¢=ramp, üü°=step, üî¥=hold, ‚ò¢Ô∏è=random, üóò=looping, üïü=clocked/gated
- üïü‚ò¢Ô∏è refers only to non-looping gated random segments in the above table (i.e. digital shift registers); ‚ò¢Ô∏è refers to all other random segments.

Single segment types in segment generator modes (* = advanced mode; all other behaviors are unchanged from original Stages):
| Segment type          | Behavior           | Slider + CV      | Pot         | Button + slider | Button + pot        |
| --------------------- | ------------------ | ---------------- | ----------- | --------------- | ------------------- |
| Green                 | Zero / R&F slew*   | Fall time*       | Rise time*  | Time range*     | Rectification*      |
| Green looping         | LFO                | Freq             | Shape       | Freq range      | Polarity            |
| Green gated           | Decay              | Time             | Shape       | Time range      | Re-trigger behavior |
| Green gated, looping  | Clocked LFO        | Div/mul          | Shape       | Div/mul range   | Polarity            |
| Yellow                | Slew               | Offset           | Time        | Quant scale     | Slider polarity     |
| Yellow looping        | Slew / Atten*      | Offset           | Time / Att* | Quant scale     | Slider polarity     |
| Yellow gated          | S&H                | Offset           | Slew        | Quant scale     | Slider polarity     |
| Yellow gated, looping | S&H / Atten*       | Offset           | Time / Att* | Quant scale     | Slider polarity     |
| Red                   | Delay              | Offset           | Time        | Quant scale     | Slider polarity     |
| Red looping           | Delay              | Offset           | Time        | Quant scale     | Slider polarity     |
| Red gated             | Timed pulse        | Offset           | Pulse width | Quant scale     | Slider polarity     |
| Red gated, looping    | Gate generator     | Offset           | Probability | Quant scale     | Slider polarity     |
| GR*                   | Double scroll      | Freq             | Slew        | Freq range      | Polarity            |
| GR looping*           | Random LFO         | Freq             | Smoothness  | Freq range      | Polarity            |
| GR gated*             | Dig shift reg      | Prob of bit flip | Steps       | Quant scale     | Polarity            |
| GR gated, looping*    | Clocked random LFO | Div/mul          | Smoothness  | Div/mul range   | Polarity            |

Segment types in groups (only green~red and button+pot are different from original Stages):
| Segment type | Behavior       | Slider + CV      | Pot   | Button + slider | Button + pot        |
| ------------ | -------------- | ---------------- | ----- | --------------- | ------------------- |
| Green        | Ramp           | Time             | Shape | Time range*     | Re-trigger behavior |
| Yellow       | Step           | Offset           | Slew  | Quant scale     | Slider polarity     |
| Red          | Hold           | Offset           | Time  | Quant scale     | Slider polarity     |
| Red looping  | Sustain        | Offset           | -     | Quant scale     | Slider polarity     |
| Green~red*   | Turing machine | Prob of bit flip | Steps | Quant scale     | Polarity            |

Segment generator LED codes:
- Blink dim red 1/sec: Bipolar / no re-trigger (for ramp) / no rectification (for green rise & fall slew)
- Oscillations between color and black: Looping mode
- Speed of looping mode oscillations (for LFO and random LFO segments): LFO freq range
- Solid green followed by ramp down: Ramp time range (default is solid)
- Smooth oscillations between green, yellow, and red: Random segment type in advanced mode
- Fading in of slider/type LED after button + slider/pot: Value of slider/pot adjusting to position (giving you a chance to change a property without affecting slider/pot value much)
- Rapid flipping between green and red: Audio-rate oscillator with alternative waveforms


Harmonic oscillator shapes:
- Normal: Sine (green), triangle (yellow), square (red)
- Looping: Ramp (green), small pulse (yellow), tiny pulse (red)

## Multi-mode usage

Hold one of the six buttons for 5 seconds to change mode. This setting is persisted when the module reboots. From left to right:

1. [Segment generator](#segment-generator)
2. [Advanced Segment generator](#advanced-segment-generator)
3. [Six independent DAHDSR envelope generators](#six-independent-dahdsr-envelope-generators)
4. [Six identical DAHDSR envelope generators](#six-identical-dahdsr-envelope-generators)
5. [Harmonic oscillator](#harmonic-oscillator), aka Ouroboros mode
6. Harmonic oscillator with [alternate controls](#harmonic-oscillator-with-alternate-controls)

For chained modules: adjacent, connected Stages will chain if both are in mode 1 (segment generator) or both are in mode 2 (adv. segment generator).
Modes 3, 4, 5, and 6 will split a chain.
So if you have connected modules in 1-1-2-2-6-2, 1-1 will be a chain, 2-2 will be a chain, and the last 2 will be isolated, like so: (1-1)-(2-2)-(6)-(2).
Changing a module's mode will automatically update the chain configuration (the LEDs will flash like on startup).
So, in the above example, if the module in mode 6 is changed to mode 2, the chaining configuration will become (1-1)-(2-2-2-2).
Modules with the original Stages firmware are ignored.

### Segment generator

This is the standard mode of the module, refer to the official [Stages manual][4]. This firmware is built on top of official [Stages 1.1][10] and [latest changes][11], therefore it includes **color-blind mode**, **S&H gate delay** and **LFO phase preservation**.

This fork adds the following features to this mode, none of which interfere with Stages normal operation; you can ignore any of them you don't care about and you won't even know they're there:

- **Polarity control for each segment type** (except non-looping ramp/green). Hold button and wiggle the pot to toggle polarity. Return the pot to its original position in order to preserve the shape/time that the segment had before you pressed the button. When bipolar, the segment will flash dull red about 1/sec.
    - Bipolar LFOs (single, looping, green) will output -5v to 5v rather than the normal 0v to 8v.
    - Bipolar step (orange) and hold (red) have an effective slider range of -8v to 8v rather than 0v to 8v.
- **Re-trigger control for ramp (green) segments**. Hold button and wiggle the pot toggle re-trigger behavior. When re-trigger is disabled, the segment will flash dull red about 1/sec.
    - With re-trigger disabled, ramp segments will cause rising gates to be ignored, whereas normally rising gates cause an envelope to re-trigger from the beginning
    - For instance, if you make an AD envelope, and disable re-trigger on the A, you get classic Maths/Serge function generator behavior, allowing for weird clock dividers, subharmonic generators, and so forth.
    - You can disable re-trigger on *any* ramp segment; the D could be disabled instead of the A, so if the envelope receives a trigger after the A (but before it ends), the trigger will be ignored.
- **Independent LFO (clocked and free) range control for each segment**:
    - For free-running, ranges are the same as Tides: 2 min to 2hz at the slowest, 0.125hz to 32.7hz (default and Stages' original range), and 8hz to about 2khz at the fastest. As with the original Stages and Tides, this range is further expandable by CV.
    - For clocked LFOs, clock multiplications are:
	- Slow: 1/32, 1/16, 1/8, 1/7, 1/6, 1/5, 1/4, 1/3, 1/2, 1
	- Medium: 1/4, 1/3, 1/2, 1, 2, 3, 4 (default; original Stages' behavior)
	- Fast: 1, 2, 3, 4, 5, 6, 7, 8, 12, 16
    - Hold the segment's button and move its slider to change LFO range. LFO range is indicated by the speed of the mode indicator LED's cycle. Frequency has been capped at ~7khz.
    - Holding the button and moving the slider to the very top will activate the audio-rate oscillator added to the official firmware in v1.2. These oscillators are fully bandlimited and have more diverse set of timbers.
    - Holding the button while you patch the gate input will cause the LFO to reset on triggers instead of clocking.
- **Time range control for ramp segments**:
    - Hold button and move slider to bottom (fast: 1 ms to 2.2 sec), middle (default: 1 ms to 16 sec), or top (slow: 16 sec to 13 min).
    - Note: Unlike with LFOs, CV range is unchanged.
    - Range is indicated by a solid green light followed by a ramp down to black. Default is solid green.
- **Quantizing step and hold segments**. Hold button and move slider on step (yellow) and hold (red) segments to control quantization. The LED will flash and change color to indicate scale.
    - Scale, from bottom to top: unquantized (LED off), chromatic (red), major (yellow), pentatonic (green)
    - When quantized, the slider has an effective range of 0v-2v and is added *before* quantization, and thus transposes in key. It can thus be used as a quantized sequencer or to select [mode](https://en.wikipedia.org/wiki/Mode_\(music\)#Modern_modes)
	- Thus, minor (aeolian) is the 6th step in major
	- Minor pentatonic is the 4th step in pentatonic
    - The segments also have all their normal behavior: yellows can thus slew between notes,
    - *Note*: There is no visual indication of scale once the button is released. Sorry :( Open to ideas here, but the LEDs are already pretty overloaded.

This fork also improves some behavior of the original Stages.
While these change basic behavior, they primarily change it in places that Stages couldn't really be used before, so hopefully will feel like strict improvements.

- **Arbitrarily slow clocked LFOs**. Previously, clocked LFOs in Stages had a reset timeout at about 5 seconds; now, the reset timeout adapts to the clock cycle, allowing for arbitrarily slow clocked LFOs (logic taken from Marbles and Tides 2). The PLL tracking will now also reset when the segment type or frequency range changes. *Note*: This change was incorporated into the official firmware in v1.2.
- **Improved audio-rate clocked LFOs**. Previously, clocked LFOs used a sophisticated clock prediction algorithm designed for low-frequency clocks and rhythms. While this allows LFOs to adapt to more complex gate sequences, it introduces artifacts at audio rates. Clocked LFOs will now detect when they're receiving an audio rate (32.7hz, aka C1, for more than 250ms) signal and switch to an algorithm tuned to audio rates, allowing them to create harmonics of other voices.
- **Bandlimiting of audio-rate LFOs**. LFOs running above 32.7hz will use bandlimiting to prevent aliasing. This results in much better-sounding square and saw waves.
- **Ramp segments track start and end value**. Previously, ramp segments would track end value but sample and hold start value. This gives you:
    - Built-in pseudo VCAs: For instance, in an ASR (green, looping red, green), plugging your signal into the red's CV in will appropriately attenuate it by attack and release.
    - Built-in pseudo crossfading: For instance, ramp-step-ramp-step (GYGY) with two signals going into the step segments will crossfade between the two signals every time it receives a gate. Ramp-hold-ramp-hold looping continuously crossfade.
    - *Note*: This change was incorporated into the official firmware in v1.2.
- **Negative quantized values in extended sequencer**. The [official extended sequencer firmware](https://forum.mutable-instruments.net/t/stages-extended-sequencer-firmware/17493) supports semitone quantization for positive voltages. This firmware adds support for negative voltages, meaning that bipolar step segments give you two octaves of quantized values.
    - Note: using quantized steps in a quantized extended sequence can give unexpected results, as the extended sequence range adjustment and quantization is applied after the step's quantization.

For any settings that require you to hold the button to change, moving the slider or pot will disable loop mode changes or multi-mode changes (and disable the normal function of the pot), so you don't need to worry about holding the button for too long.
Also, changes to those settings won't occur unless you move its respective control; thus, you won't accidentally change the range on an LFO while changing its polarity unless you move the slider.
If the slider is already in the position of the setting you want, simply wiggle it to one side and then back into the desired setting while the button is held.
After you release the button, you can then use the pot/slider as normal.
Finally, holding the button locks the value of the pot/slider so that the segment values won't change while you're changing properties (except as affected by those properties).
After releasing the button, the value of the pot/slider will move to the position within 2 seconds, allowing you to restore the original value without the changed position having too much of an effect.
This is indicated by the type LED/slider LED dimming and growing brighter as the value moves toward position.


[4]: https://mutable-instruments.net/modules/stages/manual/
[10]: https://mutable-instruments.net/modules/stages/firmware/
[11]: https://github.com/pichenettes/eurorack/commits/master

### Advanced Segment generator

This mode includes all the features of the [segment generator mode](#segment-generator), plus several additional features.
The features included in this mode change the standard workflow of Stages, such as the addition of a new segment type and the modification of the way existing segment types function; thus, they have been put in a separate mode.

##### Random segment type
This mode adds a fourth segment type, **random segments**, which gives you access to several different types of random and chaotic CV.
This segment type comes after hold (red) segments in the cycle of segments and is indicated by an LED that continuously morphs between red and green.

When used as a single segment, random segments behave as follows:

- Ungated, non-looping: A smoothly chaotic system, Chen's [double-scroll attractor](https://en.wikipedia.org/wiki/Multiscroll_attractor), a variant of Chua's attractor, with `a=42`, `b` between 1 and 6, and `c=28`.
    - Slider/CV: Frequency roughly in V/oct (the rate at which the simulation updates would give V/oct if the system was periodic... which it isn't...)
    - Button + slider: Frequency range. Rough periods (defined by crossing midpoint twice): Bottom/slow is ~33 mins (!) to about 8 secs, with even slower available with negative CV. Middle/default is 2 mins to 2hz. Top/fast is 8 secs to ~32hz.
    - Pot: Shape. Specifically, controls `b`, with CCW=1 and CW=6.
        - All the way CCW will give a curve that hovers around 4v, and spikes up or down at regular intervals (though it can get stuck around a periodic attractor with certain initial conditions; wiggle pot to free it).
        - 12:00 will give a nice variety of shapes and wiggles around a high point and low point, with some macro motion as well.
        - CW will give more jagged, hopping between high and low points that it wiggles, but generally more extreme behavior.
    - Button + pot: Polarity. Unipolar ranges between 0v and 8v. Bipolar -5v and 5v. Exact range depends on pot position.
    - You can play around with a [simulation of the attractor](https://netlogoweb.org/launch#https://gist.githubusercontent.com/qiemem/e36e443c8808a5a1d4e3bb33ed6900d3/raw/bc53e3c9a3193145a1923f69027f706730d03cd3/chaos.nlogo) that I made to tune it. The x-axis in the plots should correspond very closely with time in Stages. Behavior will differ somewhat due to floating point representation.
- Gated, non-looping: A probabilistic digital shift register, based on Tom Whitwell's [Turing Machine](https://www.modulargrid.net/e/music-thing-modular-turing-machine-mk-ii--). The segment contains a 16 bit shift register. Output is the current value of the shift register. On a rising gate, the register rotates, and the bit at the end is copied to the beginning with a probability of flipping. A great algorithm for controllable randomness, as you can lock loops you like, or let them slowly evolve.
    - Slider/CV: Probability of flipping the copied bit. At 0, the sequence will be locked. At 1, the copied bit will always flip, allowing for locked sequences of twice the length. At 0.5, the copied bit will be completely random.
    - Pot: Number of steps, from 1 to 16.
    - Button + slider: Quantization scale, same as with step and hold segments.
    - Button + pot: Polarity. Unipolar ranges between 0v and 8v. Bipolar between -5v and 5v.
- Ungated, looping: Random LFO with variable shape and frequency
    - Slider/CV: Frequency in V/oct. Frequency range is ~8 secs to ~32hz.
    - Pot: Smoothness: At full CCW, output will be stepped, uniformly random. This will increasingly smooth up until 12:00, using sine curve-like transitions between points. After 12:00, the output will transition to using a random walk to generate outputs instead. Increasing the pot further will decrease the variance of each step, resulting in small wiggles at full CW.
    - Button + slider: Frequency range:
        - Slow: 2 min to 2hz
        - Medium: 8 secs to 32hz at the middle
        - Fast: 32hz to ~8khz; when the segment exceeds about 8khz, it will switch to full noise with the pot controlling color.
    - Button + pot: Polarity. Unipolar ranges between 0v and 8v. Bipolar between -5v and 5v.
    - This video shows the range of behaviors: https://www.youtube.com/watch?v=SHhhvDU7lb4
- Gated, looping: Clocked random LFO
    - Just like random LFOs as described above, but clocked.
    - Slider/CV: Clock division/multiplication.
    - Pot: Smoothness using same shapes as unclocked random LFO.
    - Button + slider: Division/multiplication range, just as with regular LFOs:
        - Slow: 1/32, 1/16, 1/8, 1/7, 1/6, 1/5, 1/4, 1/3, 1/2, 1
        - Medium: 1/4, 1/3, 1/2, 1, 2, 3, 4 
        - Fast: 1, 2, 3, 4, 5, 6, 7, 8, 12, 16
    - Holding the segment's button while you patch the gate input will cause the random LFO to reset on triggers instead of clocking.

When used in an envelope, a **non-looping** random segment will act like a step (orange) segment with a Turing Machine as input.
When the envelope reaches the random segment, the envelope will output the value of the segment's shift register and hold until the envelope receives another trigger.
When the envelope receives the trigger, the envelope will move on from the random segment, and the segment will advance its shift register as described above.

A **looping** random segment will act like a looping hold (red) segment with a Turing Machine as input.
When the envelope reaches the random segment, the envelope will output the value of segment's shift register until the envelope's gate goes low, at which point the segment's shift register will advance.

##### Single, non-gated, non-looping ramp (green) segments slew with independent rise and fall

In normal Stages, single, non-gated, non-looping ramp segments didn't do anything.
In advanced mode, they act as slew segments with independent rise and fall control.
Slider controls fall time (just like in single, gated, non-looping ramp segments) and pot controls rise time.
CV input gives the target value.
They have the same natural RC curve of slewed yellow segments (concave rise and convex fall), making them natural for use as audio envelopes when paired with a linear VCA.
These segments have many uses beyond standard slew:

- ASR envelopes: Patch your gate into the *CV* input (not gate). When the gate is high, the segment will rise and hold until the gate is release, at which point the segment will fall. This can be a nice alternative to decay segments (single, gated, non-looping green) when you want to avoid a clicky attack, or can be used as a general purpose ASR.
- Envelope follower: Patch an audio signal into CV. Set rise short and fall longer. The segment will follow the amplitude of the audio signal. Adjust fall time to taste. Flip rise and fall to create an inverted envelope follower.

Button+pot changes polarity. In unipolar mode (default), a full-wave rectifier is applied to the incoming signal, improving behavior as an envelope follower. In bipolar mode, no rectifier is applied.

Button+slider changes the time range of the slider, similar to that of a gate ramp segment, with long time range at the top, default time range in the middle, and short time range at the bottom.

##### Single, looping step (yellow) segments attenuate

Single, looping step (yellow) segments attenuate instead of slew (both gated and non-gated).
In normal Stages, these have identical behavior to non-looping.
Pot controls attenuation amount (0 to 1 in unipolar; -1 to 1 in bipolar).
Non-gated segments will continuously attenuate, giving you Shades-like behavior.
Gated segments will still sample and hold, but with attenuation instead slew.

- Slider/CV: Offset applied to output
- Pot: Attenuation amount; attenuverts when segment is bipolar

These segments can be very handy to control the range of LFOs and random segments.
Turning on quantization with these segments can also be quite handy.
Feeding in an LFO gives you arpeggios with a controllable range.
Feeding in a TM segment gives a generative melody.

##### Single, gated, looping hold (red) segments have probability control

The pot on single, gated, looping hold segments now controls their probability of firing.
Previously, the pot did not do anything.
Fully CW will cause it to always fire (the original behavior) and fully CCW will cause it to never fire.
Note that this feature was added into the official firmware in v1.2.

### Six independent DAHDSR envelope generators
The module transforms into a generator of six independent envelopes.

Only one of the envelopes is considered selected at any time. Changes to the **slider** positions will only affect the selected envelope. Pressing a **button** will switch which envelope is selected. When switching the selected envelope, all **sliders** become disabled (led off) to avoid modifying the envelope values. Moving a slider will enable it (and its corresponding pot), updating the value of the corresponding stage in the selected envelope. Pressing the **button** of the selected envelope will immediately activate all **sliders** (and pots). Setting the **sliders** for one envelope, selecting another envelope, and then pressing the button again will effectively duplicate the settings onto the second envelope.

**Sliders** controls the duration (or level) of each stage of all envelopes. From left to right:

1. Duration of the **delay** phase
2. Duration of the **attack** phase
3. Duration of the **hold** phase
4. Duration of the **decay** phase
5. Level of the **sustain** phase
6. Duration of the **release** phase

Each duration goes from 0 to 10 seconds. The hold phase is always at maximum level (8V). Each stage can be "disabled" by setting the slider to the bottom. For example, set sliders 1 and 3 to zero to get a standard ADSR envelope.

**SHAPE/TIME** pots 2, 4 and 6 control the **shape** of the corresponding ramp stages, from accelerating through linear, to decelerating. Each pot is only enabled for the current envelope if the corresponding slider is enabled for the current envelope (slider led is lit green). Pots 1, 3 and 5 are unused.

**GATE** inputs are used to activate each of the six envelopes, which can be taken from the corresponding outputs on the bottom of the module. LEDs below pots show the current phase of each envelope: green for delay/attack/hold/decay, orange for sustain, red for release. The selected envelope will be yellow when idle while the inactive envelopes will be off when idle.


### Six identical DAHDSR envelope generators

The module transforms into a generator of six identical envelopes. **Sliders** controls the duration (or level) of each stage of all envelopes. From left to right:

1. Duration of the **delay** phase
2. Duration of the **attack** phase
3. Duration of the **hold** phase
4. Duration of the **decay** phase
5. Level of the **sustain** phase
6. Duration of the **release** phase

Each duration goes from 0 to 10 seconds. Each value can be **modulated** using **TIME/LEVEL** inputs. The hold phase is always at maximum level (8V). Each stage can be "disabled" by setting the slider to the bottom; the LED on the slider will turn off to indicate that. For example, set sliders 1 and 3 to zero to get six standard ADSR envelopes.

**SHAPE/TIME** pots 2, 4 and 6 control the **shape** of the corresponding ramp stages, from accelerating through linear, to decelerating. Pots 1, 3 and 5 are unused.

**GATE** inputs are used to activate each of the six envelopes, which can be taken from the corresponding outputs on the bottom of the module. LEDs below pots show the current phase of each envelope: green for delay/attack/hold/decay, orange for sustain, red for release, off when idle. Pressing a **button** will trigger the corresponding envelope manually, like it's a gate signal.


### Harmonic oscillator

This mode was normally accessible on the non-modified firmware by [chaining][1] the module with itself (hence the name "Ouroboros" mode). This firmware simply adds the ability to switch at runtime, without using the cable on the back of the module. All credits goes to [Stages author][9], obviously.

[9]: https://github.com/pichenettes

This fork further adds frequency range controls to this mode, allowing it to be used as a set of interrelated LFOs.

The left-most column of the module acts a little different from the others:

- Slider is for **coarse tuning** of the main oscillator
- Pot is for **fine tuning**
- CV is a **1V/oct** input for the root pitch
- Output is an **audio mix** of all the harmonics

Each one of the next five columns controls a partial:

- Pot selects the **harmonic ratio** in relation to the root pitch
- Slider and CV input control its **volume** in the mix
- Gate is for **strumming**, i.e. temporarily increase the volume with a fast decay envelope

The **buttons** cycle through different waveform for each harmonic, including the root one. Selected waveform is shown using LEDs colors:

- Green: **sine**
- Orange: **triangle**
- Red: **square**
- Flashing green (long-press): **sawtooth**
- Flashing orange: square with **small pulse width**
- Flashing red: square with **smaller pulse width**

To change the frequency range of this mode, hold the leftmost button and move the leftmost slider to the top, middle, or bottom (same as adjusting LFO range in segment generator mode).
The ranges are as follows:

- Top: 16hz to ~4khz (C0 to C8); the default range
- Middle: 0.125hz to 32hz
- Bottom: 2 min to 2hz

The middle and bottom ranges are considered "LFO" ranges.
When operating in an LFO range, this mode has a few adjusted behaviors.

- Volume control now affects the amplitude of the segments individual output in addition to its amplitude in the mix output. In audio range, volume only affects amplitude in the mix output. This gives you the ability to attenuate your LFOs.
- A rising gate on a segment's gate input will reset the phase of the LFO. It will still "strum" the LFO in the mix output (but not the individual output).

Tip: To remove an LFO from the mix, but continue to use its individual output, plug a dummy cable into its gate. This is especially useful for removing the "root" LFO from the mix (by plugging a cable into the leftmost gate input).

Note that, as in the original Stages' harmonic oscillator mode, it is possible to set frequencies in between two harmonics.
This can be really handy for creating LFOs with interesting phasing, but may be confusing at first if you're expecting the LFOs to stay exactly in sync.
The frequencies will "snap" to defined harmonics, so it shouldn't be too hard to get things to stay in time.

You can adjust the harmonic range of each segment by the segment's button and moving its slider to the top, middle, or bottom.
The harmonic ranges are:

- Top: 1x, 2x, 3x, ..., 16x
- Middle (default): 1/4x, 1/2x, 1x, 1.5x, 2x, 3x, 4x, 5x, 6x, 8x
- Bottomw: 1/16x, 1/15x, 1/14x, ..., 1x

### Harmonic oscillator with alternate controls

Same as harmonic oscillator, but controls for each partial (columns 2 to 6) are swapped:

- Pot controls the **volume** in the mix
- Slider and CV input sets the **harmonic ratio** in relation to the root pitch

This way it is possible to modulate (and therefore sequence) the harmonics with external CV.

The frequency range in this mode can be controlled just as with the normal harmonic oscillator mode (hold leftmost button and move leftmost slider).

## Other changes

The original firmware would save state when a button was released.
This firmware saves state 5 seconds after a state change occurs, reseting the the timer if another change occurs within that time.
Because this firmware uses significantly more flash storage to save state, this change reduces the strain on flash in order to extend the life of the chip.
All LEDs momentarily blink off when a save occurs.

## Known issues

- **Having too many audio-rate clocked oscillators result in clicks and pops.** The audio-rate oscillators introduced in the official v1.2 firmware are somewhat computationally intense, as is the PLL algorithm used for clocking. Thus, when you have too many clocked oscillators, segments cana struggle to keep up, produces clicks and pops or audio distortion in the 5th or 6th segment. Currently, four clocked oscillators can be comfortably run simultaneously. Note that this issue does not affect audio-rate LFOs: you can run 6 clocked audio-rate LFOs simultaneously, and they will be bandlimited and thus sound decent at audio-rate.

See https://github.com/qiemem/eurorack/issues for full list of issues.

## Changelog

Fork:

- [v1.3.0](https://github.com/qiemem/eurorack/releases/tag/v1.3.0)
    - Merge all behavior from the final [v1.2](https://pichenettes.github.io/mutable-instruments-documentation/modules/stages/firmware/) of the official firmware.
    - Fix clocked LFO performance issues to allow for six clocked LFOs.
    - Add bandlimiting to audio-rate LFOs to reduce aliasing on the original LFO shapes.
    - Make slow LFO mode correctly chain with standard mode, not advanced mode.
    - Add flipped build for using Stages upside down. Huge thank you to James Everitt for implementing the driver changes and to chadwick for help testing!
    - Make LFOs resettable by holding the button when patching the gate input.
- [v1.2.2](https://github.com/qiemem/eurorack/files/10714684/stages-bipolar-v1.2.2.zip) (never officially released)
    - [Visual cheatsheet](https://raw.githubusercontent.com/qiemem/eurorack/bipolar/stages/resources/Stages%20Qiemem%20Cheatsheets.pdf) added by Philip Belesky! #44.
    - Rework random segments to use proper, variable-shape random LFO behavior. Suggested by breach on the old MI forum (pour one out). #3
    - Allow changing harmonic ranges in ourobor mode. Suggested by [Hanz](https://www.muffwiggler.com/forum/viewtopic.php?f=16&t=235787&start=300#p3365247) (#21) and nifgam in #37.
    - Make trig to gate 1 in ouroboros mode reset LFO phases.
    - Make extended sequencer in addressable mode hold on clocks.
    - Add quantization to digital shift registers.
    - Add LED flash when changing a digital shift register length or quantized note value.
    - Make shift registers advance at end of succeeding step in a group to prevent value suddenly changing while affecting other segments.
    - Only save on button release to reduce strain on flash and interruptions while adjusting button+control params.
    - Remove codebook from quantizer to reduce memory usage.
    - Make sure looping yellow segments track correct value when used in a multi-module group. #38
    - Ensure changing loop status triggers a save. #33
    - Lots of optimizations
- [v1.1.0](https://github.com/qiemem/eurorack/releases/tag/v1.1.0)
    - Merge second version of extended sequencer mode from latest official firmware.
    - Add support for chained modules! See #13, #14, and #18. Thanks to [pyerbass](https://forum.mutable-instruments.net/t/stages-qiemems-alternative-firmware/17506/7) and others for being brave enough to test for me, to 0netwo0netwo for selling me their Stages, and to Samet for lending me their Stages!
    - Add support for turing machine segments in the extended sequencer. See #20.
    - Make the pot on single gated looping red segments control probability of firing. Suggested by [pyerbass](https://forum.mutable-instruments.net/t/stages-qiemems-alternative-firmware/17506/23).
    - Make single ungated looping random segments produce a smooth chaotic attractor. See #24. Suggested by [pyerbass](https://forum.mutable-instruments.net/t/stages-qiemems-alternative-firmware/17506/23).
    - Add slider range control for ramp segments. See #26 and #30. Implemented by @w-winter.
    - Add full-wave rectification for unipolar rise and fall segments (single, non-gated, non-looping green) to improve use as envelope followers. See #27 and #32. Implemented by @w-winter.
    - Significant optimization to the clocked LFO and UI code, allowing five clocked LFOs to be run simultaneously. See #9.
    - Minor fix when using multiple quantized segments. See #19.
    - UI improvement to rise and fall segments. See #17 (though done in a different way than described).
- [v1.0.2](https://github.com/qiemem/eurorack/releases/tag/v1.0.2)
    - Fixed groups of segments splitting correctly when new gates are patched. See #12. Thanks to pyerbass on the MI forum for catching this!
- [v1.0.1](https://github.com/qiemem/eurorack/releases/tag/v1.0.1)
    - Merge in extended sequencer from latest official firmware!
    - Ensure that 16 steps is reachable with the pot in TM mode. See #10.
    - Add support for voltage below 0v and above 8v to alt. harmonic oscillator mode. Previously the given segment would just output a constant voltage.
    - Significantly improve performance enabling more simultaneous clocked LFOs. See #9. Work in progress.
- [v1.0.0](https://github.com/qiemem/eurorack/releases/tag/v1.0.0)
    - Add harmonic oscillator frequency range control. Suggested by MW user [thetechnobear](https://www.muffwiggler.com/forum/viewtopic.php?f=16&t=235787&p=3332097#p3326831).
    - Add optional quantization to step and hold segments. Suggested by @jb0000. See #1.
    - Make single looping step segments attenuate (removes T&H). Suggested by MW users [Carrousel](https://www.muffwiggler.com/forum/viewtopic.php?p=3334476&sid=2f3e61660b8023782673d8e076106be3#p3334476) and [SavageMessiah](https://www.muffwiggler.com/forum/viewtopic.php?p=3334492&sid=2f3e61660b8023782673d8e076106be3#p3334492).
    - Make single ngnl ramp segments slew with independent rise and fall. Implementation suggested by @jb0000. See #4.
    - Improve clocked LFO audio rate and reset behavior
    - Improve audio rate cap
    - Make ramp segments track start value
    - Lock pot/slider values when holding button and then be gradually restored. Suggested by @jb0000. See #6.
    - Add cheat sheets to README. Having a quick reference suggested by MW user [baleen](https://www.muffwiggler.com/forum/viewtopic.php?f=16&t=235787&start=175#p3311760).
    - Expand range of fast and slow clocked LFOs for with musically useful values (1/16 and 1/32 for slow; 12 and 16 for fast).
    - Fix random segments crashing the module when switching to normal segment generator mode
    - Fix Stages' LFO range messing up harmonic oscillator control.

- [v1.0.0-beta4](https://github.com/qiemem/eurorack/releases/tag/v1.0.0-beta4)
    - Add advanced mode with random segments (uniform random, Turing Machine, and logistic map) and T&H (T&H moved from segment generator mode)
    - Change polarity/re-trigger control to toggle so that you can change polarity/re-trigger behavior without affecting shape/time. [Suggested by MW user jube.](https://www.muffwiggler.com/forum/viewtopic.php?f=16&t=198455&start=975#p3317120)
    - Fix an issue where LFO range selection LED brightness would override Ouroboros LED brightness. [Reported by MW user gelabs.](https://www.muffwiggler.com/forum/viewtopic.php?f=16&t=198455&start=975#p3316749)
    - Fix an issue where segments set to bipolar step or hold in normal mode would could contribute negative CV in other modes
- [v1.0.0-beta3](https://github.com/qiemem/eurorack/releases/tag/v1.0.0-beta3)
    - Fix LFO range resetting when the loop status of a different segment changed. [Reported by MW user gelabs](https://www.muffwiggler.com/forum/viewtopic.php?f=16&t=198455&start=950#p3314104).

- [v1.0.0-beta2](https://github.com/qiemem/eurorack/releases/tag/v1.0.0-beta2)
    - New hold-button-move-pot control scheme
    - Add LFO frequency range control
    - Allow for arbitrarily slow clocked LFOs
    - Add track & hold support
    - Signify bipolarity with dim red blink 1/sec
    - Revert slow LFO mode to joeSeggiola's original (works with LFO frequency range selection)

- [v1.0.0-beta](https://github.com/qiemem/eurorack/releases/tag/v1.0.0-beta)
    - Add bipolar mode for each segment type
    - Add re-trigger control for ramps
    - Change slow LFO mode to expand slider range

Original:

- [**v3**][103]: Fixed multi-mode switch to avoid unwanted segment loop toggle, independent permanent storage for segments configuration and harmonic oscillator waveform selection.
- [**v2**][102]: Alternate controls mode for harmonic oscillator.
- [**v1**][101]: Initial release, merging slower LFOs and Ouroboros toggle into a single firmware, together with a new 6xDAHDSR mode.
